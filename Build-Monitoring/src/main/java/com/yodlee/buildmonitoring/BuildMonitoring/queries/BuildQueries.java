package com.yodlee.buildmonitoring.BuildMonitoring.queries;

public class BuildQueries {
	
	public static String getBuildStatsQuery(String ip,String ts)
	{
		String buildStatsQuery= "select s.class_name as class_name, "
				+ " sum(num_errors) as total_request, "
				+ " sum(decode(TYPE_OF_ERROR, 0,num_errors,433,num_errors,473,num_errors,474,num_errors,801,num_errors,0)) as success, "
				+ " sum(decode(TYPE_OF_ERROR, 403,num_errors,408,num_errors,413,num_errors,419,num_errors,439,num_errors,444,num_errors,449,num_errors,450,num_errors,453,num_errors,475,num_errors,476,num_errors,477,num_errors,478,num_errors,479,num_errors,491,num_errors,492,num_errors,493,num_errors,494,num_errors,495,num_errors,496,num_errors,497,num_errors,498,num_errors,507,num_errors,513,num_errors,514,num_errors,707,num_errors,708,num_errors,709,num_errors,517,num_errors,570,num_errors,571,num_errors,572,num_errors,573,num_errors,574,num_errors,575,num_errors,576,num_errors,577,num_errors,578,num_errors,0)) as agent_errors, "
				+ " sum(decode(TYPE_OF_ERROR,401,num_errors,409,num_errors,410,num_errors,412,num_errors,415,num_errors,416,num_errors,418,num_errors, 424,num_errors,425,num_errors,"
				+ " 426,num_errors,431,num_errors,432,num_errors,447,num_errors,448,num_errors,1012,num_errors,0)) as site_errors, "
				+ " sum(decode(TYPE_OF_ERROR, 402,num_errors,406,num_errors,407,num_errors,411,num_errors,414,num_errors,417,num_errors,420,num_errors,421,num_errors,422,num_errors,"
				+ " 423,num_errors,427,num_errors,428,num_errors,429,num_errors,430,num_errors,434,num_errors,435,num_errors,436,num_errors,437,num_errors, "
				+ " 438,num_errors,440,num_errors,441,num_errors,442,num_errors,443,num_errors,445,num_errors,446,num_errors,451,num_errors,452,num_errors, "
				+ " 454,num_errors,455,num_errors,456,num_errors,457,num_errors,458,num_errors,459,num_errors,460,num_errors,461,num_errors,462,num_errors,"
				+ " 463,num_errors,464,num_errors,465,num_errors,466,num_errors,467,num_errors,468,num_errors,469,num_errors,470,num_errors,471,num_errors,"
				+ " 472,num_errors,480,num_errors,481,num_errors,482,num_errors,483,num_errors,484,num_errors,485,num_errors,486,num_errors,510,num_errors,"
				+ " 511,num_errors,512,num_errors,515,num_errors,516,num_errors,604,num_errors,605,num_errors,701,num_errors,702,num_errors,703,num_errors,"
				+ " 704,num_errors,705,num_errors,706,num_errors,1000,num_errors,1001,num_errors,1002,num_errors,1003,num_errors,1004,num_errors,1005,num_errors,"
				+ " 1006,num_errors,1007,num_errors,1008,num_errors,1009,num_errors,1010,num_errors,1011,num_errors,1013,num_errors,505,num_errors,506,num_errors,"
				+ "509,num_errors,518,num_errors,519,num_errors,520,num_errors,521,num_errors,522,num_errors,523,num_errors,524,num_errors,526,num_errors,0)) as uar_errors,"
				+ " sum(decode(TYPE_OF_ERROR, 200,num_errors,201,num_errors,202,num_errors,300,num_errors,303,num_errors,400,num_errors,404,num_errors,508,num_errors,600,num_errors,602,num_errors,603,num_errors,601,num_errors,525,num_errors,0)) as infra_errors, "
				+ " SUM(DECODE(TYPE_OF_ERROR, 402,NUM_ERRORS,0)) AS ERR402,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 406,NUM_ERRORS,0)) AS ERR406,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 407,NUM_ERRORS,0)) AS ERR407,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 414,NUM_ERRORS,0)) AS ERR414,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 422,NUM_ERRORS,0)) AS ERR422,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 427,NUM_ERRORS,0)) AS ERR427,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 428,NUM_ERRORS,0)) AS ERR428,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 429,NUM_ERRORS,0)) AS ERR429,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 518,NUM_ERRORS,0)) AS ERR518,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 519,NUM_ERRORS,0)) AS ERR519,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 522,NUM_ERRORS,0)) AS ERR522,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 523,NUM_ERRORS,0)) AS ERR523,"	
				+ " ROUND((100.0 * ( sum(decode(TYPE_OF_ERROR, 0,num_errors,433,num_errors,473,num_errors,474,num_errors,801,num_errors,0)) /  sum(num_errors))),2)   as successPer,"
				+ " round ((sum(ss.num_errors*AVG_SCRIPT_LATENCY)/sum(ss.num_errors))/1000,2) as script_latency, "
				+ "ROUND ((SUM(DECODE(TYPE_OF_ERROR,404,num_errors,508,num_errors,525,num_errors,0)*AVG_SCRIPT_LATENCY)/SUM(ss.num_errors))/1000,2) AS infra_script_latency,"
				+ " round (avg(AVG_NUM_OF_NAVIGATIONS),1) as num_of_navigations, "
				+ " SUM(DECODE(TYPE_OF_ERROR, 413,NUM_ERRORS,0)) AS ERR413,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 570,NUM_ERRORS,571,NUM_ERRORS,572,NUM_ERRORS,573,NUM_ERRORS,574,NUM_ERRORS,575,NUM_ERRORS,576,NUM_ERRORS,577,NUM_ERRORS,578,NUM_ERRORS,0)) AS ERRDOCDOWNLOAD,"
				+ " ROUND((100.0 * ( sum(decode(TYPE_OF_ERROR, 402,num_errors,0)) /  sum(num_errors))),2)   as err402Per,"
				+ " ROUND((100.0 * ( sum(decode(TYPE_OF_ERROR, 413,num_errors,0)) /  sum(num_errors))),2)   as err413Per "
				+ " from site_stats_suminfo ss,sum_info s "
				+ " where  TIMESTAMP > (" + ts + ")"
				+ " and s.sum_info_id = ss.sum_info_id "
				+ " and ss.gatherer_ip in (" + ip + ")"	
				+ " group by s.class_name" + " order by 2 desc";
		return buildStatsQuery;
	}
	
	public static String getBuildDailyStatsQuery(String ip,String ts)
	{
		String buildStatsQuery= "select ss.gatherer_ip as gatherer_ip, "
				+ " sum(num_errors) as total_request, "
				+ " sum(decode(TYPE_OF_ERROR, 0,num_errors,433,num_errors,473,num_errors,474,num_errors,801,num_errors,0)) as success, "
				+ " sum(decode(TYPE_OF_ERROR, 403,num_errors,408,num_errors,413,num_errors,419,num_errors,439,num_errors,444,num_errors,449,num_errors,450,num_errors,453,num_errors,475,num_errors,476,num_errors,477,num_errors,478,num_errors,479,num_errors,491,num_errors,492,num_errors,493,num_errors,494,num_errors,495,num_errors,496,num_errors,497,num_errors,498,num_errors,507,num_errors,513,num_errors,514,num_errors,707,num_errors,708,num_errors,709,num_errors,517,num_errors,570,num_errors,571,num_errors,572,num_errors,573,num_errors,574,num_errors,575,num_errors,576,num_errors,577,num_errors,578,num_errors,0)) as agent_errors, "
				+ " sum(decode(TYPE_OF_ERROR,401,num_errors,409,num_errors,410,num_errors,412,num_errors,415,num_errors,416,num_errors,418,num_errors, 424,num_errors,425,num_errors,"
				+ " 426,num_errors,431,num_errors,432,num_errors,447,num_errors,448,num_errors,1012,num_errors,0)) as site_errors, "
				+ " sum(decode(TYPE_OF_ERROR, 402,num_errors,406,num_errors,407,num_errors,411,num_errors,414,num_errors,417,num_errors,420,num_errors,421,num_errors,422,num_errors,"
				+ " 423,num_errors,427,num_errors,428,num_errors,429,num_errors,430,num_errors,434,num_errors,435,num_errors,436,num_errors,437,num_errors, "
				+ " 438,num_errors,440,num_errors,441,num_errors,442,num_errors,443,num_errors,445,num_errors,446,num_errors,451,num_errors,452,num_errors, "
				+ " 454,num_errors,455,num_errors,456,num_errors,457,num_errors,458,num_errors,459,num_errors,460,num_errors,461,num_errors,462,num_errors,"
				+ " 463,num_errors,464,num_errors,465,num_errors,466,num_errors,467,num_errors,468,num_errors,469,num_errors,470,num_errors,471,num_errors,"
				+ " 472,num_errors,480,num_errors,481,num_errors,482,num_errors,483,num_errors,484,num_errors,485,num_errors,486,num_errors,510,num_errors,"
				+ " 511,num_errors,512,num_errors,515,num_errors,516,num_errors,604,num_errors,605,num_errors,701,num_errors,702,num_errors,703,num_errors,"
				+ " 704,num_errors,705,num_errors,706,num_errors,1000,num_errors,1001,num_errors,1002,num_errors,1003,num_errors,1004,num_errors,1005,num_errors,"
				+ " 1006,num_errors,1007,num_errors,1008,num_errors,1009,num_errors,1010,num_errors,1011,num_errors,1013,num_errors,505,num_errors,506,num_errors,"
				+ "509,num_errors,518,num_errors,519,num_errors,520,num_errors,521,num_errors,522,num_errors,523,num_errors,524,num_errors,526,num_errors,0)) as uar_errors,"
				+ " sum(decode(TYPE_OF_ERROR, 200,num_errors,201,num_errors,202,num_errors,300,num_errors,303,num_errors,400,num_errors,404,num_errors,508,num_errors,600,num_errors,602,num_errors,603,num_errors,601,num_errors,525,num_errors,0)) as infra_errors, "
				+ " SUM(DECODE(TYPE_OF_ERROR, 402,NUM_ERRORS,0)) AS ERR402,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 406,NUM_ERRORS,0)) AS ERR406,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 407,NUM_ERRORS,0)) AS ERR407,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 414,NUM_ERRORS,0)) AS ERR414,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 422,NUM_ERRORS,0)) AS ERR422,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 427,NUM_ERRORS,0)) AS ERR427,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 428,NUM_ERRORS,0)) AS ERR428,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 429,NUM_ERRORS,0)) AS ERR429,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 518,NUM_ERRORS,0)) AS ERR518,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 519,NUM_ERRORS,0)) AS ERR519,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 522,NUM_ERRORS,0)) AS ERR522,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 523,NUM_ERRORS,0)) AS ERR523,"	
				+ " ROUND((100.0 * ( sum(decode(TYPE_OF_ERROR, 0,num_errors,433,num_errors,473,num_errors,474,num_errors,801,num_errors,0)) /  sum(num_errors))),2)   as successPer,"
				+ " round ((sum(ss.num_errors*AVG_SCRIPT_LATENCY)/sum(ss.num_errors))/1000,2) as script_latency, "
				+ "ROUND ((SUM(DECODE(TYPE_OF_ERROR,404,num_errors,508,num_errors,525,num_errors,0)*AVG_SCRIPT_LATENCY)/SUM(ss.num_errors))/1000,2) AS infra_script_latency,"
				+ " round (avg(AVG_NUM_OF_NAVIGATIONS),1) as num_of_navigations, "
				+ " SUM(DECODE(TYPE_OF_ERROR, 413,NUM_ERRORS,0)) AS ERR413,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 570,NUM_ERRORS,571,NUM_ERRORS,572,NUM_ERRORS,573,NUM_ERRORS,574,NUM_ERRORS,575,NUM_ERRORS,576,NUM_ERRORS,577,NUM_ERRORS,578,NUM_ERRORS,0)) AS ERRDOCDOWNLOAD,"
				+ " ROUND((100.0 * ( sum(decode(TYPE_OF_ERROR, 402,num_errors,0)) /  sum(num_errors))),2)   as err402Per,"
				+ " ROUND((100.0 * ( sum(decode(TYPE_OF_ERROR, 413,num_errors,0)) /  sum(num_errors))),2)   as err413Per,"
				+ "to_char(ss.timestamp, 'MM/dd/yyyy') as DATE1"
				+ " from site_stats_suminfo ss,sum_info s "
				+ " where  TIMESTAMP > (" + ts + ")"
				+ " and s.sum_info_id = ss.sum_info_id "
				+ " and ss.gatherer_ip in (" + ip + ")"	
				+ " group by to_char(TIMESTAMP, 'MM/dd/yyyy'),ss.gatherer_ip"
				+ " ORDER BY TO_CHAR(ss.timestamp, 'MM/dd/yyyy')";
		
		return buildStatsQuery;
	}
	public static String getAgentBuildStatsQuery(String ip,String ts,String className)
	{
		String buildStatsQuery= "select to_char(new_time(timestamp,'GMT','PDT'),'mm-dd-yyyy ') as DATE1, "
				+ "ss.gatherer_ip as gatherer_ip, "
				+ " sum(num_errors) as total_request, "
				+ " sum(decode(TYPE_OF_ERROR, 0,num_errors,433,num_errors,473,num_errors,474,num_errors,801,num_errors,0)) as success, "
				+ " sum(decode(TYPE_OF_ERROR, 403,num_errors,408,num_errors,413,num_errors,419,num_errors,439,num_errors,444,num_errors,449,num_errors,450,num_errors,453,num_errors,475,num_errors,476,num_errors,477,num_errors,478,num_errors,479,num_errors,491,num_errors,492,num_errors,493,num_errors,494,num_errors,495,num_errors,496,num_errors,497,num_errors,498,num_errors,507,num_errors,513,num_errors,514,num_errors,707,num_errors,708,num_errors,709,num_errors,517,num_errors,570,num_errors,571,num_errors,572,num_errors,573,num_errors,574,num_errors,575,num_errors,576,num_errors,577,num_errors,578,num_errors,0)) as agent_errors, "
				+ " sum(decode(TYPE_OF_ERROR,401,num_errors,409,num_errors,410,num_errors,412,num_errors,415,num_errors,416,num_errors,418,num_errors, 424,num_errors,425,num_errors,"
				+ " 426,num_errors,431,num_errors,432,num_errors,447,num_errors,448,num_errors,1012,num_errors,0)) as site_errors, "
				+ " sum(decode(TYPE_OF_ERROR, 402,num_errors,406,num_errors,407,num_errors,411,num_errors,414,num_errors,417,num_errors,420,num_errors,421,num_errors,422,num_errors,"
				+ " 423,num_errors,427,num_errors,428,num_errors,429,num_errors,430,num_errors,434,num_errors,435,num_errors,436,num_errors,437,num_errors, "
				+ " 438,num_errors,440,num_errors,441,num_errors,442,num_errors,443,num_errors,445,num_errors,446,num_errors,451,num_errors,452,num_errors, "
				+ " 454,num_errors,455,num_errors,456,num_errors,457,num_errors,458,num_errors,459,num_errors,460,num_errors,461,num_errors,462,num_errors,"
				+ " 463,num_errors,464,num_errors,465,num_errors,466,num_errors,467,num_errors,468,num_errors,469,num_errors,470,num_errors,471,num_errors,"
				+ " 472,num_errors,480,num_errors,481,num_errors,482,num_errors,483,num_errors,484,num_errors,485,num_errors,486,num_errors,510,num_errors,"
				+ " 511,num_errors,512,num_errors,515,num_errors,516,num_errors,604,num_errors,605,num_errors,701,num_errors,702,num_errors,703,num_errors,"
				+ " 704,num_errors,705,num_errors,706,num_errors,1000,num_errors,1001,num_errors,1002,num_errors,1003,num_errors,1004,num_errors,1005,num_errors,"
				+ " 1006,num_errors,1007,num_errors,1008,num_errors,1009,num_errors,1010,num_errors,1011,num_errors,1013,num_errors,505,num_errors,506,num_errors,"
				+ "509,num_errors,518,num_errors,519,num_errors,520,num_errors,521,num_errors,522,num_errors,523,num_errors,524,num_errors,526,num_errors,0)) as uar_errors,"
				+ " sum(decode(TYPE_OF_ERROR, 200,num_errors,201,num_errors,202,num_errors,300,num_errors,303,num_errors,400,num_errors,404,num_errors,508,num_errors,600,num_errors,602,num_errors,603,num_errors,601,num_errors,525,num_errors,0)) as infra_errors, "
				+ " SUM(DECODE(TYPE_OF_ERROR, 402,NUM_ERRORS,0)) AS ERR402,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 406,NUM_ERRORS,0)) AS ERR406,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 407,NUM_ERRORS,0)) AS ERR407,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 414,NUM_ERRORS,0)) AS ERR414,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 422,NUM_ERRORS,0)) AS ERR422,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 427,NUM_ERRORS,0)) AS ERR427,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 428,NUM_ERRORS,0)) AS ERR428,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 429,NUM_ERRORS,0)) AS ERR429,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 518,NUM_ERRORS,0)) AS ERR518,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 519,NUM_ERRORS,0)) AS ERR519,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 522,NUM_ERRORS,0)) AS ERR522,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 523,NUM_ERRORS,0)) AS ERR523,"	
				+ " ROUND((100.0 * ( sum(decode(TYPE_OF_ERROR, 0,num_errors,433,num_errors,473,num_errors,474,num_errors,801,num_errors,0)) /  sum(num_errors))),2)   as successPer,"
				+ " round ((sum(ss.num_errors*AVG_SCRIPT_LATENCY)/sum(ss.num_errors))/1000,2) as script_latency, "
				+ " ROUND ((SUM(DECODE(TYPE_OF_ERROR,404,num_errors,508,num_errors,525,num_errors,0)*AVG_SCRIPT_LATENCY)/SUM(ss.num_errors))/1000,2) AS infra_script_latency,"
				+ " round (avg(AVG_NUM_OF_NAVIGATIONS),1) as num_of_navigations, "
				+ " SUM(DECODE(TYPE_OF_ERROR, 413,NUM_ERRORS,0)) AS ERR413,"
				+ " SUM(DECODE(TYPE_OF_ERROR, 570,NUM_ERRORS,571,NUM_ERRORS,572,NUM_ERRORS,573,NUM_ERRORS,574,NUM_ERRORS,575,NUM_ERRORS,576,NUM_ERRORS,577,NUM_ERRORS,578,NUM_ERRORS,0)) AS ERRDOCDOWNLOAD,"
				+ " ROUND((100.0 * ( sum(decode(TYPE_OF_ERROR, 402,num_errors,0)) /  sum(num_errors))),2)   as err402Per,"
				+ " ROUND((100.0 * ( sum(decode(TYPE_OF_ERROR, 413,num_errors,0)) /  sum(num_errors))),2)   as err413Per"
				+ " from site_stats_suminfo ss,sum_info s "
				+ " where  TIMESTAMP > (" + ts + ")"
				+ " and s.sum_info_id = ss.sum_info_id "
				+ " and ss.gatherer_ip in (" + ip + ")"	
				+ " and s.class_name in ('"+className+"')"
				+ " group by to_char(new_time(timestamp,'GMT','PDT'),'mm-dd-yyyy '),ss.gatherer_ip"
				+ " order by to_char(new_time(timestamp,'GMT','PDT'),'mm-dd-yyyy ')";
		return buildStatsQuery;
		
	}
	

}
